<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××©×—×§ ××ª××˜×™×§×” - ×›×™×ª×” ×–×³</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0;
            padding: 20px;
        }
        
        .game-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            text-align: center;
            max-width: 550px;
            width: 100%;
        }
        
        h1 {
            color: #764ba2;
            margin-bottom: 5px;
            font-size: 28px;
        }
        
        .subtitle {
            color: #666;
            margin-bottom: 15px;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin: 15px 0;
            padding: 12px;
            background: #f0f0f0;
            border-radius: 10px;
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-value {
            font-size: 22px;
            font-weight: bold;
            color: #764ba2;
        }
        
        .stat-label {
            font-size: 12px;
            color: #666;
        }
        
        .topic-select {
            margin: 15px 0;
        }
        
        .topic-select select {
            padding: 10px 15px;
            font-size: 15px;
            border: 2px solid #764ba2;
            border-radius: 10px;
            background: white;
            cursor: pointer;
            width: 100%;
            max-width: 300px;
        }
        
        .question-area {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 15px 0;
            min-height: 140px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .question {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 8px;
            line-height: 1.4;
        }
        
        .question-type {
            font-size: 13px;
            opacity: 0.9;
        }
        
        .hint {
            font-size: 14px;
            margin-top: 10px;
            opacity: 0.85;
        }
        
        .answer-input {
            width: 100%;
            padding: 15px;
            font-size: 22px;
            text-align: center;
            border: 3px solid #ddd;
            border-radius: 10px;
            margin: 10px 0;
            transition: border-color 0.3s;
        }
        
        .answer-input:focus {
            outline: none;
            border-color: #764ba2;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 16px;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin: 5px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(118, 75, 162, 0.4);
        }
        
        .btn-small {
            padding: 8px 15px;
            font-size: 14px;
            background: #999;
        }
        
        .feedback {
            padding: 12px;
            border-radius: 10px;
            margin: 12px 0;
            font-size: 16px;
            font-weight: bold;
            min-height: 45px;
        }
        
        .feedback.correct {
            background: #d4edda;
            color: #155724;
        }
        
        .feedback.wrong {
            background: #f8d7da;
            color: #721c24;
        }
        
        .feedback.empty {
            background: transparent;
        }
        
        .streak {
            font-size: 14px;
            color: #666;
            margin-top: 8px;
        }
        
        .streak.hot {
            color: #e74c3c;
            font-weight: bold;
        }
        
        .explanation {
            background: #fff3cd;
            color: #856404;
            padding: 12px;
            border-radius: 10px;
            margin-top: 10px;
            font-size: 14px;
            text-align: right;
            display: none;
        }
        
        .explanation.show {
            display: block;
        }
        
        .topics-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin: 15px 0;
        }
        
        .topic-btn {
            padding: 10px;
            border: 2px solid #764ba2;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
        }
        
        .topic-btn:hover, .topic-btn.active {
            background: #764ba2;
            color: white;
        }
        
        .difficulty {
            margin: 10px 0;
            font-size: 14px;
        }
        
        .difficulty label {
            margin: 0 10px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>ğŸ§® ××©×—×§ ××ª××˜×™×§×”</h1>
        <p class="subtitle">×›×™×ª×” ×–×³ - ×ª×•×›× ×™×ª ×œ×™××•×“×™× ××œ××”</p>
        
        <div class="topics-grid">
            <button class="topic-btn active" onclick="selectTopic('all')">×›×œ ×”× ×•×©××™×</button>
            <button class="topic-btn" onclick="selectTopic('equations')">××©×•×•××•×ª</button>
            <button class="topic-btn" onclick="selectTopic('signed')">××¡×¤×¨×™× ××›×•×•× ×™×</button>
            <button class="topic-btn" onclick="selectTopic('powers')">×—×–×§×•×ª</button>
            <button class="topic-btn" onclick="selectTopic('fractions')">×©×‘×¨×™×</button>
            <button class="topic-btn" onclick="selectTopic('percent')">××—×•×–×™×</button>
            <button class="topic-btn" onclick="selectTopic('angles')">×–×•×•×™×•×ª</button>
            <button class="topic-btn" onclick="selectTopic('area')">×©×˜×— ×•×”×™×§×£</button>
            <button class="topic-btn" onclick="selectTopic('algebra')">×‘×™×˜×•×™×™× ××œ×’×‘×¨×™×™×</button>
            <button class="topic-btn" onclick="selectTopic('order')">×¡×“×¨ ×¤×¢×•×œ×•×ª</button>
        </div>
        
        <div class="stats">
            <div class="stat">
                <div class="stat-value" id="score">0</div>
                <div class="stat-label">× ×™×§×•×“</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="correct">0</div>
                <div class="stat-label">× ×›×•× ×•×ª</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="total">0</div>
                <div class="stat-label">×¡×”×´×›</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="percent">0%</div>
                <div class="stat-label">××—×•×– ×”×¦×œ×—×”</div>
            </div>
        </div>
        
        <div class="question-area">
            <div class="question-type" id="questionType">××©×•×•××”</div>
            <div class="question" id="question">3x + 5 = 14</div>
            <div class="hint" id="hint">××¦× ××ª x</div>
        </div>
        
        <input type="text" class="answer-input" id="answer" placeholder="×”×§×œ×“ ×ª×©×•×‘×”..." onkeypress="handleKeyPress(event)">
        
        <div>
            <button class="btn" onclick="checkAnswer()">×‘×“×•×§ âœ“</button>
            <button class="btn" onclick="newQuestion()">×©××œ×” ×—×“×©×” âŸ³</button>
            <button class="btn btn-small" onclick="showHint()">×¨××– ğŸ’¡</button>
        </div>
        
        <div class="feedback empty" id="feedback"></div>
        <div class="explanation" id="explanation"></div>
        <div class="streak" id="streak"></div>
    </div>

    <script>
        let score = 0;
        let correctCount = 0;
        let totalCount = 0;
        let currentAnswer = 0;
        let currentExplanation = '';
        let streak = 0;
        let selectedTopic = 'all';
        
        const topics = {
            equations: {
                name: '××©×•×•××•×ª',
                generate: function() {
                    const type = randomInt(1, 3);
                    if (type === 1) {
                        // ax + b = c
                        const a = randomInt(2, 8);
                        const x = randomInt(1, 12);
                        const b = randomInt(1, 15);
                        const result = a * x + b;
                        return {
                            question: `${a}x + ${b} = ${result}`,
                            answer: x,
                            hint: '××¦× ××ª x',
                            explanation: `${a}x = ${result} - ${b} = ${result - b}, ××– x = ${result - b} Ã· ${a} = ${x}`
                        };
                    } else if (type === 2) {
                        // ax - b = c
                        const a = randomInt(2, 6);
                        const x = randomInt(3, 10);
                        const b = randomInt(1, 10);
                        const result = a * x - b;
                        return {
                            question: `${a}x - ${b} = ${result}`,
                            answer: x,
                            hint: '××¦× ××ª x',
                            explanation: `${a}x = ${result} + ${b} = ${result + b}, ××– x = ${result + b} Ã· ${a} = ${x}`
                        };
                    } else {
                        // ax + b = cx + d
                        const x = randomInt(2, 8);
                        const a = randomInt(3, 7);
                        const c = randomInt(1, a - 1);
                        const b = randomInt(1, 10);
                        const d = (a - c) * x + b;
                        return {
                            question: `${a}x + ${b} = ${c}x + ${d}`,
                            answer: x,
                            hint: '××¦× ××ª x (×”×¢×‘×¨ ××™×‘×¨×™×)',
                            explanation: `${a}x - ${c}x = ${d} - ${b}, ××– ${a-c}x = ${d-b}, x = ${x}`
                        };
                    }
                }
            },
            signed: {
                name: '××¡×¤×¨×™× ××›×•×•× ×™×',
                generate: function() {
                    const type = randomInt(1, 4);
                    if (type === 1) {
                        // ×—×™×‘×•×¨
                        const a = randomInt(-15, 15);
                        const b = randomInt(-15, 15);
                        const result = a + b;
                        const aStr = a < 0 ? `(${a})` : a;
                        const bStr = b < 0 ? `(${b})` : b;
                        return {
                            question: `${aStr} + ${bStr} = ?`,
                            answer: result,
                            hint: '×—×©×‘ ××ª ×”×ª×•×¦××”',
                            explanation: `×›×©××—×‘×¨×™× ${a} ×•-${b} ××§×‘×œ×™× ${result}`
                        };
                    } else if (type === 2) {
                        // ×—×™×¡×•×¨
                        const a = randomInt(-12, 12);
                        const b = randomInt(-12, 12);
                        const result = a - b;
                        const aStr = a < 0 ? `(${a})` : a;
                        const bStr = b < 0 ? `(${b})` : b;
                        return {
                            question: `${aStr} - ${bStr} = ?`,
                            answer: result,
                            hint: '×–×›×•×¨: ×—×™×¡×•×¨ = ×—×™×‘×•×¨ ×”×”×•×¤×›×™',
                            explanation: `${a} - ${b} = ${a} + (${-b}) = ${result}`
                        };
                    } else if (type === 3) {
                        // ×›×¤×œ
                        const a = randomInt(-8, 8);
                        const b = randomInt(-8, 8);
                        if (a === 0 || b === 0) return this.generate();
                        const result = a * b;
                        const aStr = a < 0 ? `(${a})` : a;
                        const bStr = b < 0 ? `(${b})` : b;
                        return {
                            question: `${aStr} Ã— ${bStr} = ?`,
                            answer: result,
                            hint: '×©×œ×™×œ×™ Ã— ×©×œ×™×œ×™ = ×—×™×•×‘×™',
                            explanation: `${a} Ã— ${b} = ${result} (${a < 0 && b < 0 ? '×©× ×™ ×©×œ×™×œ×™×™× = ×—×™×•×‘×™' : a < 0 || b < 0 ? '×¡×™×× ×™× ×©×•× ×™× = ×©×œ×™×œ×™' : '×©× ×™ ×—×™×•×‘×™×™× = ×—×™×•×‘×™'})`
                        };
                    } else {
                        // ×—×™×œ×•×§
                        const b = randomInt(-8, 8);
                        if (b === 0) return this.generate();
                        const result = randomInt(-8, 8);
                        if (result === 0) return this.generate();
                        const a = b * result;
                        const aStr = a < 0 ? `(${a})` : a;
                        const bStr = b < 0 ? `(${b})` : b;
                        return {
                            question: `${aStr} Ã· ${bStr} = ?`,
                            answer: result,
                            hint: '×©×œ×™×œ×™ Ã· ×©×œ×™×œ×™ = ×—×™×•×‘×™',
                            explanation: `${a} Ã· ${b} = ${result}`
                        };
                    }
                }
            },
            powers: {
                name: '×—×–×§×•×ª',
                generate: function() {
                    const type = randomInt(1, 3);
                    if (type === 1) {
                        const base = randomInt(2, 7);
                        const exp = randomInt(2, 4);
                        const result = Math.pow(base, exp);
                        return {
                            question: `${base}<sup>${exp}</sup> = ?`,
                            answer: result,
                            hint: `×›×¤×•×œ ${base} ×‘×¢×¦××• ${exp} ×¤×¢××™×`,
                            explanation: `${base}^${exp} = ${Array(exp).fill(base).join(' Ã— ')} = ${result}`
                        };
                    } else if (type === 2) {
                        // ×—×–×§×” ×©×œ ××¡×¤×¨ ×©×œ×™×œ×™
                        const base = randomInt(2, 4);
                        const exp = randomInt(2, 3);
                        const result = Math.pow(-base, exp);
                        return {
                            question: `(${-base})<sup>${exp}</sup> = ?`,
                            answer: result,
                            hint: exp % 2 === 0 ? '×—×–×§×” ×–×•×’×™×ª ×©×œ ×©×œ×™×œ×™ = ×—×™×•×‘×™' : '×—×–×§×” ××™-×–×•×’×™×ª ×©×œ ×©×œ×™×œ×™ = ×©×œ×™×œ×™',
                            explanation: `(${-base})^${exp} = ${result}`
                        };
                    } else {
                        // ×›×¤×œ ×—×–×§×•×ª ×¢× ××•×ª×• ×‘×¡×™×¡
                        const base = randomInt(2, 5);
                        const exp1 = randomInt(1, 3);
                        const exp2 = randomInt(1, 3);
                        const result = exp1 + exp2;
                        return {
                            question: `${base}<sup>${exp1}</sup> Ã— ${base}<sup>${exp2}</sup> = ${base}<sup>?</sup>`,
                            answer: result,
                            hint: '×‘×›×¤×œ ×—×–×§×•×ª ×¢× ××•×ª×• ×‘×¡×™×¡ - ××—×‘×¨×™× ××¢×¨×™×›×™×',
                            explanation: `${base}^${exp1} Ã— ${base}^${exp2} = ${base}^(${exp1}+${exp2}) = ${base}^${result}`
                        };
                    }
                }
            },
            fractions: {
                name: '×©×‘×¨×™×',
                generate: function() {
                    const type = randomInt(1, 4);
                    if (type === 1) {
                        // ×—×™×‘×•×¨ ×¢× ××›× ×” ××©×•×ª×£
                        const d = randomInt(3, 10);
                        const n1 = randomInt(1, d - 1);
                        const n2 = randomInt(1, d - n1);
                        const sum = n1 + n2;
                        return {
                            question: `${n1}/${d} + ${n2}/${d} = ?/${d}`,
                            answer: sum,
                            hint: '××›× ×” ××©×•×ª×£ - ××—×‘×¨×™× ××•× ×™×',
                            explanation: `${n1}/${d} + ${n2}/${d} = (${n1}+${n2})/${d} = ${sum}/${d}`
                        };
                    } else if (type === 2) {
                        // ×”×›×¤×œ×”
                        const n1 = randomInt(1, 5);
                        const d1 = randomInt(2, 6);
                        const n2 = randomInt(1, 5);
                        const d2 = randomInt(2, 6);
                        const resultN = n1 * n2;
                        const resultD = d1 * d2;
                        return {
                            question: `${n1}/${d1} Ã— ${n2}/${d2} = ?/${resultD}`,
                            answer: resultN,
                            hint: '××•× ×” Ã— ××•× ×”, ××›× ×” Ã— ××›× ×”',
                            explanation: `(${n1}Ã—${n2})/(${d1}Ã—${d2}) = ${resultN}/${resultD}`
                        };
                    } else if (type === 3) {
                        // ×—×™×œ×•×§
                        const n1 = randomInt(1, 6);
                        const d1 = randomInt(2, 6);
                        const n2 = randomInt(1, 4);
                        const d2 = randomInt(2, 5);
                        const resultN = n1 * d2;
                        const resultD = d1 * n2;
                        return {
                            question: `${n1}/${d1} Ã· ${n2}/${d2} = ?/${resultD}`,
                            answer: resultN,
                            hint: '×—×™×œ×•×§ = ×›×¤×œ ×‘×”×•×¤×›×™',
                            explanation: `${n1}/${d1} Ã— ${d2}/${n2} = ${resultN}/${resultD}`
                        };
                    } else {
                        // ×”××¨×” ×œ×¢×©×¨×•× ×™
                        const pairs = [[1,2,0.5], [1,4,0.25], [3,4,0.75], [1,5,0.2], [2,5,0.4], [3,5,0.6]];
                        const [n, d, result] = pairs[randomInt(0, pairs.length - 1)];
                        return {
                            question: `${n}/${d} = ? (×¢×©×¨×•× ×™)`,
                            answer: result,
                            hint: '×—×œ×§ ××•× ×” ×‘××›× ×”',
                            explanation: `${n} Ã· ${d} = ${result}`
                        };
                    }
                }
            },
            percent: {
                name: '××—×•×–×™×',
                generate: function() {
                    const type = randomInt(1, 3);
                    if (type === 1) {
                        const percent = [10, 20, 25, 30, 40, 50, 75][randomInt(0, 6)];
                        const number = randomInt(2, 20) * 10;
                        const result = (percent / 100) * number;
                        return {
                            question: `${percent}% ××ª×•×š ${number} = ?`,
                            answer: result,
                            hint: `${percent}% = ${percent}/100`,
                            explanation: `${percent}/100 Ã— ${number} = ${result}`
                        };
                    } else if (type === 2) {
                        // ××”×• ×”××—×•×–
                        const percent = [10, 20, 25, 50][randomInt(0, 3)];
                        const number = randomInt(2, 10) * 20;
                        const part = (percent / 100) * number;
                        return {
                            question: `${part} ××ª×•×š ${number} ×–×” ×›××” ××—×•×–?`,
                            answer: percent,
                            hint: '×—×œ×§ Ã· ×©×œ× Ã— 100',
                            explanation: `${part}/${number} Ã— 100 = ${percent}%`
                        };
                    } else {
                        // ××”×• ×”××¡×¤×¨ ×”××§×•×¨×™
                        const percent = [10, 20, 25, 50][randomInt(0, 3)];
                        const number = randomInt(2, 10) * 20;
                        const part = (percent / 100) * number;
                        return {
                            question: `${part} ×”× ${percent}% ×××¡×¤×¨. ××”×• ×”××¡×¤×¨?`,
                            answer: number,
                            hint: '×—×œ×§ Ã· ××—×•×– Ã— 100',
                            explanation: `${part} Ã· ${percent} Ã— 100 = ${number}`
                        };
                    }
                }
            },
            angles: {
                name: '×–×•×•×™×•×ª',
                generate: function() {
                    const type = randomInt(1, 5);
                    if (type === 1) {
                        // ×–×•×•×™×•×ª ××©×œ×™××•×ª ×œ-180
                        const a = randomInt(30, 150);
                        const b = 180 - a;
                        return {
                            question: `×©×ª×™ ×–×•×•×™×•×ª ×¦××•×“×•×ª. ××—×ª ${a}Â°. ××”×™ ×”×©× ×™×™×”?`,
                            answer: b,
                            hint: '×–×•×•×™×•×ª ×¦××•×“×•×ª = 180Â°',
                            explanation: `180Â° - ${a}Â° = ${b}Â°`
                        };
                    } else if (type === 2) {
                        // ×–×•×•×™×•×ª ×§×•×“×§×•×“×™×•×ª
                        const a = randomInt(20, 160);
                        return {
                            question: `×©×ª×™ ×–×•×•×™×•×ª ×§×•×“×§×•×“×™×•×ª. ××—×ª ${a}Â°. ××”×™ ×”×©× ×™×™×”?`,
                            answer: a,
                            hint: '×–×•×•×™×•×ª ×§×•×“×§×•×“×™×•×ª ×©×•×•×ª',
                            explanation: `×–×•×•×™×•×ª ×§×•×“×§×•×“×™×•×ª ×©×•×•×ª: ${a}Â°`
                        };
                    } else if (type === 3) {
                        // ×¡×›×•× ×–×•×•×™×•×ª ×‘××©×•×œ×©
                        const a = randomInt(30, 80);
                        const b = randomInt(30, 80);
                        const c = 180 - a - b;
                        return {
                            question: `×‘××©×•×œ×©: ×–×•×•×™×ª ××³=${a}Â°, ×–×•×•×™×ª ×‘×³=${b}Â°. ×–×•×•×™×ª ×’×³=?`,
                            answer: c,
                            hint: '×¡×›×•× ×–×•×•×™×•×ª ×‘××©×•×œ×© = 180Â°',
                            explanation: `180Â° - ${a}Â° - ${b}Â° = ${c}Â°`
                        };
                    } else if (type === 4) {
                        // ×–×•×•×™×•×ª ××ª×—×œ×¤×•×ª
                        const a = randomInt(40, 140);
                        return {
                            question: `×©× ×™ ×™×©×¨×™× ××§×‘×™×œ×™× ×•×—×•×ª×š. ×–×•×•×™×ª ××ª×—×œ×¤×ª ×œ-${a}Â° ×”×™×?`,
                            answer: a,
                            hint: '×–×•×•×™×•×ª ××ª×—×œ×¤×•×ª ×‘×™×Ÿ ××§×‘×™×œ×™× ×©×•×•×ª',
                            explanation: `×–×•×•×™×•×ª ××ª×—×œ×¤×•×ª ×©×•×•×ª: ${a}Â°`
                        };
                    } else {
                        // ×¡×›×•× ×–×•×•×™×•×ª ×‘××¨×•×‘×¢
                        const a = randomInt(60, 100);
                        const b = randomInt(60, 100);
                        const c = randomInt(60, 100);
                        const d = 360 - a - b - c;
                        return {
                            question: `×‘××¨×•×‘×¢: ${a}Â°, ${b}Â°, ${c}Â°. ×”×–×•×•×™×ª ×”×¨×‘×™×¢×™×ª?`,
                            answer: d,
                            hint: '×¡×›×•× ×–×•×•×™×•×ª ×‘××¨×•×‘×¢ = 360Â°',
                            explanation: `360Â° - ${a}Â° - ${b}Â° - ${c}Â° = ${d}Â°`
                        };
                    }
                }
            },
            area: {
                name: '×©×˜×— ×•×”×™×§×£',
                generate: function() {
                    const type = randomInt(1, 5);
                    if (type === 1) {
                        // ×©×˜×— ××œ×‘×Ÿ
                        const a = randomInt(3, 12);
                        const b = randomInt(3, 12);
                        const area = a * b;
                        return {
                            question: `×©×˜×— ××œ×‘×Ÿ: ××•×¨×š ${a}, ×¨×•×—×‘ ${b}`,
                            answer: area,
                            hint: '×©×˜×— ××œ×‘×Ÿ = ××•×¨×š Ã— ×¨×•×—×‘',
                            explanation: `${a} Ã— ${b} = ${area}`
                        };
                    } else if (type === 2) {
                        // ×”×™×§×£ ××œ×‘×Ÿ
                        const a = randomInt(3, 10);
                        const b = randomInt(3, 10);
                        const perimeter = 2 * (a + b);
                        return {
                            question: `×”×™×§×£ ××œ×‘×Ÿ: ××•×¨×š ${a}, ×¨×•×—×‘ ${b}`,
                            answer: perimeter,
                            hint: '×”×™×§×£ ××œ×‘×Ÿ = 2Ã—(××•×¨×š+×¨×•×—×‘)',
                            explanation: `2 Ã— (${a} + ${b}) = ${perimeter}`
                        };
                    } else if (type === 3) {
                        // ×©×˜×— ××©×•×œ×©
                        const base = randomInt(4, 12);
                        const height = randomInt(2, 10) * 2; // ××¡×¤×¨ ×–×•×’×™
                        const area = (base * height) / 2;
                        return {
                            question: `×©×˜×— ××©×•×œ×©: ×‘×¡×™×¡ ${base}, ×’×•×‘×” ${height}`,
                            answer: area,
                            hint: '×©×˜×— ××©×•×œ×© = (×‘×¡×™×¡ Ã— ×’×•×‘×”) Ã· 2',
                            explanation: `(${base} Ã— ${height}) Ã· 2 = ${area}`
                        };
                    } else if (type === 4) {
                        // ×©×˜×— ×¨×™×‘×•×¢
                        const side = randomInt(3, 12);
                        const area = side * side;
                        return {
                            question: `×©×˜×— ×¨×™×‘×•×¢ ×¢× ×¦×œ×¢ ${side}`,
                            answer: area,
                            hint: '×©×˜×— ×¨×™×‘×•×¢ = ×¦×œ×¢Â²',
                            explanation: `${side}Â² = ${area}`
                        };
                    } else {
                        // ×”×™×§×£ ××¢×’×œ (××¢×•×’×œ)
                        const r = randomInt(2, 10);
                        const circumference = Math.round(2 * Math.PI * r);
                        return {
                            question: `×”×™×§×£ ××¢×’×œ ×¢× ×¨×“×™×•×¡ ${r} (×¢×’×œ ×œ×©×œ×, Ï€â‰ˆ3.14)`,
                            answer: circumference,
                            hint: '×”×™×§×£ ××¢×’×œ = 2Ï€r',
                            explanation: `2 Ã— 3.14 Ã— ${r} â‰ˆ ${circumference}`
                        };
                    }
                }
            },
            algebra: {
                name: '×‘×™×˜×•×™×™× ××œ×’×‘×¨×™×™×',
                generate: function() {
                    const type = randomInt(1, 3);
                    if (type === 1) {
                        // ×”×¦×‘×” ×‘×‘×™×˜×•×™
                        const a = randomInt(2, 5);
                        const b = randomInt(1, 10);
                        const x = randomInt(2, 8);
                        const result = a * x + b;
                        return {
                            question: `×× x=${x}, ××”×• ×”×¢×¨×š ×©×œ ${a}x + ${b}?`,
                            answer: result,
                            hint: '×”×¦×‘ ××ª ×”×¢×¨×š ×‘××§×•× x',
                            explanation: `${a}Ã—${x} + ${b} = ${a*x} + ${b} = ${result}`
                        };
                    } else if (type === 2) {
                        // ×›×™× ×•×¡ ××™×‘×¨×™× ×“×•××™×
                        const a = randomInt(2, 8);
                        const b = randomInt(1, 6);
                        const result = a + b;
                        return {
                            question: `${a}x + ${b}x = ?x`,
                            answer: result,
                            hint: '×›× ×¡ ××™×‘×¨×™× ×“×•××™×',
                            explanation: `${a}x + ${b}x = (${a}+${b})x = ${result}x`
                        };
                    } else {
                        // ×”×¦×‘×” ×‘×‘×™×˜×•×™ ×¢× ×©× ×™ ××©×ª× ×™×
                        const a = randomInt(1, 4);
                        const b = randomInt(1, 4);
                        const x = randomInt(2, 5);
                        const y = randomInt(2, 5);
                        const result = a * x + b * y;
                        return {
                            question: `×× x=${x}, y=${y}, ××”×• ${a}x + ${b}y?`,
                            answer: result,
                            hint: '×”×¦×‘ ××ª ×©× ×™ ×”×¢×¨×›×™×',
                            explanation: `${a}Ã—${x} + ${b}Ã—${y} = ${a*x} + ${b*y} = ${result}`
                        };
                    }
                }
            },
            order: {
                name: '×¡×“×¨ ×¤×¢×•×œ×•×ª',
                generate: function() {
                    const type = randomInt(1, 4);
                    if (type === 1) {
                        const a = randomInt(2, 8);
                        const b = randomInt(2, 5);
                        const c = randomInt(1, 10);
                        const result = a + b * c;
                        return {
                            question: `${a} + ${b} Ã— ${c} = ?`,
                            answer: result,
                            hint: '×›×¤×œ ×œ×¤× ×™ ×—×™×‘×•×¨',
                            explanation: `${a} + (${b}Ã—${c}) = ${a} + ${b*c} = ${result}`
                        };
                    } else if (type === 2) {
                        const a = randomInt(2, 6);
                        const b = randomInt(2, 6);
                        const c = randomInt(2, 5);
                        const result = (a + b) * c;
                        return {
                            question: `(${a} + ${b}) Ã— ${c} = ?`,
                            answer: result,
                            hint: '×¡×•×’×¨×™×™× ×§×•×“×',
                            explanation: `(${a+b}) Ã— ${c} = ${result}`
                        };
                    } else if (type === 3) {
                        const a = randomInt(10, 30);
                        const b = randomInt(2, 5);
                        const c = randomInt(2, 4);
                        const result = a - b * c;
                        return {
                            question: `${a} - ${b} Ã— ${c} = ?`,
                            answer: result,
                            hint: '×›×¤×œ ×œ×¤× ×™ ×—×™×¡×•×¨',
                            explanation: `${a} - (${b}Ã—${c}) = ${a} - ${b*c} = ${result}`
                        };
                    } else {
                        const a = randomInt(2, 5);
                        const b = randomInt(2, 4);
                        const c = randomInt(1, 5);
                        const result = Math.pow(a, b) + c;
                        return {
                            question: `${a}<sup>${b}</sup> + ${c} = ?`,
                            answer: result,
                            hint: '×—×–×§×” ×§×•×“× ×œ×—×™×‘×•×¨',
                            explanation: `${Math.pow(a,b)} + ${c} = ${result}`
                        };
                    }
                }
            }
        };
        
        function randomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
        
        function selectTopic(topic) {
            selectedTopic = topic;
            document.querySelectorAll('.topic-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            newQuestion();
        }
        
        function getRandomTopic() {
            if (selectedTopic === 'all') {
                const keys = Object.keys(topics);
                return keys[randomInt(0, keys.length - 1)];
            }
            return selectedTopic;
        }
        
        function newQuestion() {
            const topicKey = getRandomTopic();
            const topic = topics[topicKey];
            const q = topic.generate();
            
            document.getElementById('questionType').textContent = topic.name;
            document.getElementById('question').innerHTML = q.question;
            document.getElementById('hint').textContent = q.hint;
            
            currentAnswer = q.answer;
            currentExplanation = q.explanation;
            
            document.getElementById('answer').value = '';
            document.getElementById('feedback').textContent = '';
            document.getElementById('feedback').className = 'feedback empty';
            document.getElementById('explanation').className = 'explanation';
            document.getElementById('explanation').textContent = '';
            document.getElementById('answer').focus();
        }
        
        function showHint() {
            const explanation = document.getElementById('explanation');
            explanation.textContent = 'ğŸ’¡ ×¨××–: ' + document.getElementById('hint').textContent;
            explanation.className = 'explanation show';
        }
        
        function checkAnswer() {
            const userAnswer = parseFloat(document.getElementById('answer').value);
            const feedback = document.getElementById('feedback');
            const explanation = document.getElementById('explanation');
            
            if (isNaN(userAnswer)) {
                feedback.textContent = 'âš ï¸ ×”×§×œ×“ ××¡×¤×¨';
                feedback.className = 'feedback wrong';
                return;
            }
            
            totalCount++;
            
            if (Math.abs(userAnswer - currentAnswer) < 0.01) {
                correctCount++;
                streak++;
                const points = 10 + (streak > 3 ? (streak - 3) * 5 : 0);
                score += points;
                
                feedback.textContent = `âœ“ × ×›×•×Ÿ! +${points} × ×§×•×“×•×ª`;
                feedback.className = 'feedback correct';
                explanation.className = 'explanation';
                
                if (streak >= 3) {
                    document.getElementById('streak').textContent = `ğŸ”¥ ×¨×¦×£ ×©×œ ${streak} ×ª×©×•×‘×•×ª × ×›×•× ×•×ª!`;
                    document.getElementById('streak').className = 'streak hot';
                } else {
                    document.getElementById('streak').textContent = '';
                }
                
                setTimeout(newQuestion, 1500);
            } else {
                streak = 0;
                feedback.textContent = `âœ— ×œ× × ×›×•×Ÿ. ×”×ª×©×•×‘×”: ${currentAnswer}`;
                feedback.className = 'feedback wrong';
                explanation.textContent = 'ğŸ“ ×”×¡×‘×¨: ' + currentExplanation;
                explanation.className = 'explanation show';
                document.getElementById('streak').textContent = '';
                document.getElementById('streak').className = 'streak';
            }
            
            updateStats();
        }
        
        function updateStats() {
            document.getElementById('score').textContent = score;
            document.getElementById('correct').textContent = correctCount;
            document.getElementById('total').textContent = totalCount;
            const pct = totalCount > 0 ? Math.round((correctCount / totalCount) * 100) : 0;
            document.getElementById('percent').textContent = pct + '%';
        }
        
        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                checkAnswer();
            }
        }
        
        // ×”×ª×—×œ ×¢× ×©××œ×” ×¨××©×•× ×”
        newQuestion();
    </script>
</body>
</html>
